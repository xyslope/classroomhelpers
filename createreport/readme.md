# Word文書をひとまとめにするスクリプト
Word文書をひとまとめしてPDF化するときに、いくつか便利な機能をまとめています。

生成時に、タイトルとページ数のリストを出力してくれるので目次を作成する際に楽ができます。

# 使い方
docsディレクトリにWord文書ファイルを入れておく。

filelist.csvにはファイル名のリストを入れておく。このファイルは、「file名,タイトル,氏名,ページ数,目次」からなっており、
あとで目次を生成するときに利用できる。

上記を用意して、スクリプトを実行すると、標準出力に目次、out.pdfに統合された文書が生成される。

目次はコピーしてWordで改めて目次ページを作成する。作者は最初にダミーの目次ページをつくっておいて、あとで差し替える。

## 目次の生成
1. あとでページがずれないように、ダミーの目次をWordで作成して、ファイルリストにも含めておく。
2. PDFを生成すると、スクリプトの出力として、目次が出力される。
3. 出力された目次をダミーの目次に貼り付けて、レイアウトを調整する。
4a. 再度スクリプトを実行する。
4b. 全部を再pdf化するのが手間なら、目次だけをpdfとして出力して、スクリプトを-scオプション付きで実行する。

以上で目次の入ったpdfが生成できる。

## 全体のページ番号の挿入
現状のスクリプトではこれはできないので、Adobeなどのツールを使って手動でページ番号を挿入する。

以下と公式ドキュメントをみながら作成中。以下のサイトはPyPDF2のバージョンが古いようなので、エラーメッセージを見ながら修正して、動くようにした。

[https://gammasoft.jp/python-example/python-add-page-number-to-pdf/](GAMMA SOFT)

[https://pypdf2.readthedocs.io/en/3.0.0/index.html](公式ドキュメント)


ついでに、こちらも参照。
[https://zenn.dev/takahashi_m/articles/e00473bdeb9dd8](Pythonのreportlabの使い方まとめ)

# 主な機能
## 空白ページの追加（-b）
Word文書を統合する際に、すべての文書が奇数はじまりになるように、奇数ページの文書には空白ページを追加します。

同梱のblank.pdfを挿入するので、blank.pdfを別のものに替えてもいいかもしれません。

## PDF化をスキップする（-sc）
WordからPDFを生成するのはちょっと時間がかかるので、一部の文書だけを差し替える場合は、手動でPDF化した方が早いです。
そのばあい、このオプションを使用すれば、PDFの統合だけを行ってくれます。

